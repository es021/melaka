var myApp=angular.module("sample.home",["ui.router","auth0"])
myApp.config(["$stateProvider","$urlRouterProvider","authProvider",function(o,e,t){o.state("home",{url:"/home",cache:!1,controller:"HomeController",templateUrl:"home/home.html"}),o.state("allNotifications",{url:"/allNotifications?pageNumber",controller:"NotificationController",templateUrl:"home/allNotifications.html"})}]),myApp.controller("HomeController",["$scope","growl","$state","BackandService","PublicService","USER_TYPE","NOTI_CATEGORY",function(o,e,t,i,n,r,s){function a(){for(var e=1;e<=3;e++)o.userCount_load[e]=!0,u(e)}function u(e){i.getUserCountByUserType(e).then(function(t){e==r.SUPPLIER&&(o.suppliersCount=t.data[0].total_user),e==r.STOCKIST&&(o.stockistsCount=t.data[0].total_user),e==r.DROPSHIP&&(o.dropshipsCount=t.data[0].total_user),o.userCount_load[e]=!1},function(o){n.errorCallbackFunction(o,"default")})}function l(e){i.getUserPicture(e).then(function(e){o.userPicture=e.data[0],console.log(o.userPicture),200==e.status&&(o.authProfile.picture!=o.userPicture.picture||o.authProfile.picture_large!=o.userPicture.picture_large||o.authProfile.cover_photo!=o.userPicture.cover_photo?(console.log("Updating picture"),i.updateLatestPicture(o.authProfile,o.userInSession.user_id).then(function(e){o.myProfileLoad=!1},function(e){n.errorCallbackFunction(e,"default"),o.myProfileLoad=!1})):o.myProfileLoad=!1)},function(e){n.errorCallbackFunction(e,"default"),o.myProfileLoad=!1})}function c(o){o.myNotification={},o.myNotificationLoad=!0,f(o.userInSession.user_id,5),"facebook"==o.authProfile.auth_id.split("|")[0]&&(o.myProfileLoad=!0,l(o.userInSession.user_id))}function f(e,t){o.NOTI_CATEGORY=s,i.getAllNotificationByUserId(e,t).then(function(e){console.log("Return Result from getAllNotificationByUserId"),console.log(e),o.myNotificationLoad=!1,200==e.status&&(o.myNotification=e.data)},function(e){console.log(e),n.errorCallbackFunction(e,"Opps! Something went wrong."),o.myNotificationLoad=!1})}o.update=!0,o.closeUpdate=function(){o.update=!1},o.authProfile=JSON.parse(window.localStorage.getItem("AuthProfile")),o.userInSession=JSON.parse(window.localStorage.getItem("UserInSession")),console.log(o.userInSession),n.initHeaderFooter(o.authProfile,o.userInSession),o.userCount_load=["count",0,0,0],o.suppliersCount=0,o.stockistsCount=0,o.dropshipsCount=0,o.USER_TYPE=r,null!=o.authProfile?(null!=o.userInSession&&c(o),n.initSideMenu()):a(),o.refreshNotification=function(){console.log("Refresh"),f(o.userInSession.user_id,5),e.info("Notification is up to date",{title:"Refresh Notification!"})},o.isRead=function(o){o.isRead=!0,i.setNotificationIsReadTrue(o.id).then(function(o){console.log("Return Result from isRead"),console.log(o),200==o.status},function(o){n.errorCallbackFunction(o,"Opps! Something went wrong.")})}}]),myApp.controller("NotificationController",["$scope","growl","$state","$stateParams","BackandService","PublicService","USER_TYPE","NOTI_CATEGORY",function(o,e,t,i,n,r,s,a){function u(e,t){o.myNotificationLoad=!0,o.NOTI_CATEGORY=a,n.getAllNotificationByUserId_page(e,t).then(function(e){console.log("Return Result from getAllNotificationByUserId_page"),console.log(e),o.myNotificationLoad=!1,200==e.status&&(o.myNotification=e.data.data)},function(e){console.log(e),r.errorCallbackFunction(e,"Opps! Something went wrong."),o.myNotificationLoad=!1})}return o.authProfile=JSON.parse(window.localStorage.getItem("AuthProfile")),o.userInSession=JSON.parse(window.localStorage.getItem("UserInSession")),console.log(o.userInSession),o.myNotificationLoad=!1,o.pageNumber=i.pageNumber,console.log(o.userInSession),null==o.userInSession?void t.go("myProfile"):(u(o.userInSession.user_id,o.pageNumber),o.refreshNotification=function(){console.log("Refresh"),u(o.userInSession.user_id,o.pageNumber),e.info("Notification is up to date",{title:"Refresh Notification!"})},o.isRead=function(o){o.isRead=!0,n.setNotificationIsReadTrue(o.id).then(function(o){console.log("Return Result from isRead"),console.log(o),200==o.status},function(o){r.errorCallbackFunction(o,"Opps! Something went wrong.")})},void(o.getMoreNotification=function(e){console.log(e),"next"==e&&(o.pageNumber=Number(o.pageNumber)+1),"previous"==e&&(o.pageNumber=Number(o.pageNumber)-1),t.go("allNotifications",{pageNumber:o.pageNumber})}))}]),myApp.controller("AdminController",["$scope","growl","$state","$stateParams","BackandService","PublicService","USER_TYPE","NOTI_CATEGORY",function(o,e,t,i,n,r,s,a){o.picture="",o.deletePicture=function(){console.log("Deleting "+o.picture),n.deleteFile(o.picture).then(function(e){200==e.status&&(console.log(e),r.successCallbackFunction(o.picture,"Successfully Delete One Picture"))})}}])
