<ion-view>
<ion-content class="text-center has-header has-footer padding">
<p>
<h3 class="title">{{showObject.name}}</h3>
<a href="" class="link small" ng-click="showUser(showObject.user_id)">by {{showObject.user_name}}</a>

<div class="list card text-left">

<!-- ***************************************************************************************************************** -->
  <!-- Product Tabs For Supplier -->
  <div ng-if="authenticated" class="text-center">
    <br>
    <button class="button button-small button-balanced icon-left ion-edit" 
    ng-click="editProduct(showObject.id,userInSession.user_id)">Edit Product</button>
    <button class="button button-small button-assertive icon-left ion-edit" ng-click="comfirmDeleteProduct()">Delete</button>
    <br><br>
  </div>

<!-- ***************************************************************************************************************** -->
  <!-- Product Tabs For Linked User -->
  <div ng-if="linked" class="item tabs">
    <a ng-show="!loading" ng-click="showFunction('info')" class="button icon-left ion-information-circled button-clear button-dark">Show Info</a>
    <a ng-show="!loading" ng-click="showFunction('request')" class="button icon-left ion-paper-airplane button-clear button-dark">Request Product</a>

    <div ng-show="loading">
    <img id="mySpinner" ng-src="{{APP_CONSTANT.LOADER}}"/>
    </div>
  </div>

<!-- ***************************************************************************************************************** -->
<!-- ***************************** INFO ****************************************************************************** -->
  <div ng-if="show=='info'" class="item item-body text-center">
          <h2><strong>{{showObject.name}}</strong><br><span class="small">Last Updated {{lastUpdatedAgo}}<span></h2>          
            
            <span ng-if="showObject.quantity > 0" class="label label-success">{{showObject.quantity}} available</span>
            <span ng-if="showObject.quantity <= 0 || showObject.quantity == null" class="label label-danger">Out Of Stock</span>
            
            <br><br>
            
            <a style="text-decoration:none;" target="_blank" href="{{showObject.picture}}">
            <img src="{{showObject.picture}}" class="full-image image-fit">
            </a>

            <br><br>
  
            <span class="info-with-fa">
                <li class="fa fa-suitcase" >
                </li>
                {{showObject.category}}
            </span> 
            
            <br>
            
            <span class="info-with-fa" ng-if="!hasCustomPricing">
                <li class="fa fa-tag" >
                </li>
                RM {{showObject.price_per_unit}} / unit
                <br><br>
            </span> 

            <span class="info-with-fa" ng-if="hasCustomPricing">
                <br>
                <li class="fa fa-tag" >
                </li>
                <u>Custom Pricing</u>

            <div>
              <ul class="list-inline small text-center">
                <li ng-repeat="custom in customPricingList">
                  <strong>{{custom.from}}-{{custom.to}}</strong>
                  <br>
                  <span class="text-muted">RM {{custom.price}}</span>

                </li>
              </ul>
            </div>
            </span>

          <div class="small item item-body text-muted">
            <span ng-if="showObject.description == '' || showObject.description == null">
            There is no description for this product
            </span>    
            <span ng-if="showObject.description != ''">
            {{showObject.description}}
            </span>          
          </div>        
  </div>

<!-- ********************************************************************************************************************** -->
<!-- **************************** REQUEST FORM **************************************************************************** -->
  <div ng-if="show=='request'" class="item item-body">
            <div class="text-center">
              <span ng-if="showObject.quantity > 0" class="label label-success">{{showObject.quantity}} available</span>
              <span ng-if="showObject.quantity <= 0 || showObject.quantity == null" class="label label-danger">Out Of Stock</span>  
              <br>
            <span class="info-with-fa" ng-if="!hasCustomPricing">
                <br>
                <li class="fa fa-tag" >
                </li>
                RM {{showObject.price_per_unit}} / unit
            </span> 

            <span class="info-with-fa" ng-if="hasCustomPricing">
                <br>
                <li class="fa fa-tag" >
                </li>
                <u>Custom Pricing</u>
              <div>
                <ul class="list-inline small text-center">
                  <li ng-repeat="custom in customPricingList">
                    <strong>{{custom.from}}-{{custom.to}}</strong>
                    <br>
                    <span class="text-muted">RM {{custom.price}}</span>

                  </li>
                </ul>
              </div>
            </span>
          </div>
    <hr>
    <div class="text-left">

    <form role="form">
    <div class="form-group" ng-form='requestform'>
      
      <!-- Total Price -->
      <div class="text-center">
          <h4>Total Price For This Request</h4><h1><span class="label label-pill label-success">RM {{newRequest.total_price}}</span></h1>
          <br>
      </div>

      <div class="list">
        <label class="item item-input item-select">
          <div class="input-label">Request Type</div>
          <select ng-model="newRequest.type" required>
            <option selected>Delivery</option>
            <option>Pick Up</option>
          </select>
        </label>

      <label class="item item-input item-stacked-label">
        <span class="input-label">Quantity</span><br>
        <small ng-if="newRequest.quantity > showObject.quantity" class="text-assertive">[Error] The quantity is larger than available product</small>
        <input type="number" value="1000" min="0" step="1" ng-model="newRequest.quantity" ng-change="updateTotalPrice()" required>
      </label>  


      <label class="item item-input item-stacked-label">
        <span class="input-label">Additional Note</span>
        <textarea class="form-control" placeholder="Optional" rows="4" ng-model="newRequest.note"></textarea>
      </label>
      </div>
      
      <div class="text-center" ng-show="loadingRequest">
          Requesting Product<br>
          <img id="mySpinner" ng-src="{{APP_CONSTANT.LOADER}}"/>
      </div>

      <button ng-disabled="!requestform.$valid || loadingRequest || (newRequest.quantity > showObject.quantity)" 
        type="submit" class="button button-block button-positive" ng-click="requestProduct()">Send Request</button>

    </div>
    </form>
    </div>

  </div>

  <!-- ********************************************************************************************************************** -->
  <!-- **************************** VISIT SUPPLIER **************************************************************************** -->
  <div class="item text-center">
    <button class="button button-small button-positive icon-right ion-arrow-right-a" ng-click="showUser(showObject.user_id)">Visit Supplier</button>
  </div>

</div>

</p>

</ion-view>
</ion-content>