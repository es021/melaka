<ion-view>
<ion-content class="text-center has-header has-footer padding" scroll="false">
  <div class="col-xs-12 col-xs-offset-0 col-md-8 col-md-offset-2 nopadding">

  <div class="text-center" ng-show="myProfileLoad">
    <img id="mySpinner" ng-src="{{APP_CONSTANT.LOADER}}"/>
  </div>


<div ng-show="!myProfileLoad">
<h2 class="title">{{authProfile.nickname}}</h2>

<div ng-if= "userInSession == null">
  <img ng-if="authProfile.picture_large != '' && authProfile.picture_large != null" src="{{authProfile.picture_large}}" class="img-circle profile-image" width="100">
  
  <img ng-if="authProfile.picture_large == '' || authProfile.picture_large == null" src="{{authProfile.picture}}" class="img-circle profile-image" width="100">
  
  <h4 class="subtitle">It seems that you are new here!</h4>

<hr>
    <div ng-app="sample" ng-controller="RegisterController">
          <h4 class="title">Lets get started<br><small>Choose Your Line of Business</small></h4>
            <a class="fa fa-home btn-positive smGlobalBtnLarge" ng-click="register(USER_TYPE.SUPPLIER)"><span class="large-round-btn-text"><br>Supplier</span></a>
            <a class="fa fa-archive btn-royal smGlobalBtnLarge" ng-click="register(USER_TYPE.STOCKIST)"><span class="large-round-btn-text"><br>Stockist</span></a>
            <a class="fa fa-users btn-assertive smGlobalBtnLarge" ng-click="register(USER_TYPE.DROPSHIP)"><span class="large-round-btn-text"><br>Dropship</span></a>
            <br>
    </div>

          <hr>
      <h4 class="title">Which one am I?</h4>

      <div class="card text-center">

          <div class="row">  
            <div class="col col-75">
              <blockquote class="blockquote-reverse" style="padding-left:15px;">
                <h4 class="text-{{USER_TYPE.ION_COLOR.SUPPLIER}}"><strong>Supplier</strong></h4>
                  <p class="paragraph text-muted text-right">
                    You <strong>provide the products</strong> yourself and you <strong>have agents</strong> to distribute it
                  </p>
              </blockquote>
            </div>  
            <div class="col">
              <li class="fa fa-home text-{{USER_TYPE.ION_COLOR.SUPPLIER}}" style="font-size:60px; height: auto; width: auto; margin-left:auto; margin-right:auto;"></li>
            </div>
          </div>  

        <div class="row">  
          <div class="col">
            <li class="fa fa-archive text-{{USER_TYPE.ION_COLOR.STOCKIST}}" style="padding-left:25px; font-size:60px; height: auto; width: auto; margin-left:auto; margin-right:auto;"></li>
          </div>      
          <div class="col col-75">
            <blockquote>
              <div class="paragraph text-muted text-left">
                <h4 class="text-{{USER_TYPE.ION_COLOR.STOCKIST}}"><strong>Stockist</strong></h4>
                  <p class="paragraph text-muted text-left">
              You have <strong>one or more suppliers</strong> where you buy your products.<br>You have your <strong>own inventory</strong> and you might have <strong>some dropship agents</strong> working for you
                </p>
              </div>
            </blockquote>
          </div>  
        </div>  

          <div class="row">  
            <div class="col col-75">
              <blockquote class="blockquote-reverse" style="padding-left:15px;">
                <h4 class="text-{{USER_TYPE.ION_COLOR.DROPSHIP}}"><strong>Dropship</strong></h4>
                  <p class="paragraph text-muted text-right">
              You <strong>receive orders from customers</strong> and you <strong>request</strong> your supplier to <strong>send the orders</strong> to the customers.<br>You <strong>do not hold</strong> any inventory
                  </p>  
              </blockquote>
            </div>  
            <div class="col">
              <li class="fa fa-users text-{{USER_TYPE.ION_COLOR.DROPSHIP}}" style="font-size:60px; height: auto; width: auto; margin-left:auto; margin-right:auto;"></li>
            </div>
          </div>  

      </div>

</div>

<div ng-if = "userInSession != null">

<div class="text-center" ng-show="showObjectLoad">
    <img id="mySpinner" ng-src="{{APP_CONSTANT.LOADER}}"/>
</div>


<div class="list card text-left" ng-if="page == 'show'">
    <div class="item text-center">
        <button class="button button-small button-balanced icon-left ion-edit" ng-click="editProfile()">Edit Profile</button>
    </div>

    <div class="item item-body text-center">
      <img src="{{myProfile.picture}}" class="img-circle profile-image-no-shadow" width="50">


      <h2><strong>{{myProfile.first_name}} {{myProfile.last_name}}</strong><br><span class="small">Member Since {{myProfile.created_at.getDate()}}<span></h2>          
      
      <div class="small">
        <span ng-if="myProfile.company_name != ''" class="fa fa-building" aria-hidden="true" style="padding-right:10px;"> </span>{{myProfile.company_name}}<br>
        <span class="fa fa-phone" aria-hidden="true" style="padding-right:10px;"> </span>{{myProfile.phone_number}}<br>
        <span class="fa fa-envelope" aria-hidden="true" style="padding-right:10px;"> </span>{{myProfile.email}}<br>
        <span class="fa fa-map-marker" aria-hidden="true" style="padding-right:10px;"> </span>

        <a href="" ng-click="toggleFullAddress()">
          <span ng-show="fullAddress">
            {{myProfile.address_line_1}}<br>
            <span ng-if="myProfile.address_line_2 != ''">{{myProfile.address_line_2}}<br></span>
            {{myProfile.city}}<br>{{myProfile.state}}, {{myProfile.postal_code}}
          </span>

          <span ng-show="!fullAddress">
            {{myProfile.city}}, {{myProfile.state}}
          </span>
        </a>
        
      </div>
      
      <br>

      <div class="small item item-body">
        <span ng-if="myProfile.about != ''" class="text-muted">{{myProfile.about}}</span>
        <span ng-if="myProfile.about == ''" class="text-muted">There is no more information about this user</span>
      </div>


    </div>
    <div  ng-if="myProfile.user_type < USER_TYPE.DROPSHIP" class="item text-center">
      <button class="button button-small button-orange icon-left ion-bag" ng-click="showProductList(myProfile.id)">My Product</button>
    </div>

</div>

<!-- #################################################################################################################################### -->
<!-- #################################################################################################################################### -->
<!-- ###################################### EDIT PROFILE ################################################################################ -->

<div class="list card text-left" ng-if="page == 'edit'">
    <div class="item text-center">
        <button class="button button-small button-assertive icon-left ion-android-cancel" ng-click="showProfile()">Cancel</button>
    </div>
    <div class="item item-avatar">
      <img src="{{myProfile.picture}}">
      <p><strong>{{myProfile.user_type.getUserType()}}</strong>  | User Id {{myProfile.id}}</p>

   
   <form role="form">
    <div class="form-group" ng-form='editForm'>
     
     <!-- first name -->
     <label class="item-input">
      <input type="text" class="form-control" placeholder="First Name *" ng-model="myProfile.first_name" required>
    </label>

     <!-- last name -->
     <label class="item-input">
      <input type="text" class="form-control" placeholder="Last Name *" ng-model="myProfile.last_name" required>
    </label>

     <!-- company name -->
     <label class="item-input">
      <input type="text" class="form-control" placeholder="Company Name" ng-model="myProfile.company_name">
    </label>

    <!-- email -->
    <label class="item-input">
      <input type="text" class="form-control" placeholder="Email" ng-model="myProfile.email" >
    </label> 
      
    <!-- phone number -->      
    <label class="item-input">
      <input type="text" class="input-medium bfh-phone" placeholder="Phone Number *" ng-model="myProfile.phone_number" required data-country="US">
    </label> 
   
    <!-- address-line1 input-->
    <label class="item-input">
      <input type="text" class="form-control" id="address-line1" name="address-line1" placeholder="Address Line 1 *" ng-model="myProfile.address_line_1" required>
    </label>    

    <!-- address-line2 input-->
    <label class="item-input">
      <input type="text" class="form-control" id="address-line2" name="address-line2" placeholder="Address Line 2" ng-model="myProfile.address_line_2">
    </label>    

    <!-- city input-->
    <label class="item-input">
      <input type="text" class="form-control" id="city" name="city" placeholder="City *" ng-model="myProfile.city" required>
    </label>      

    <!-- postal-code input-->
    <label class="item-input">
      <input type="text" class="form-control" id="postal-code" name="postal-code" placeholder="Postal Code *" ng-model="myProfile.postal_code" required>
    </label>        

     <!-- state -->
    <div class="list">
    <label class="item-input item-select">
      <div class="input-label">{{myProfile.state}}</div>
      <select ng-model="myProfile.state" required>
        <option selected>Johor</option>
        <option>Kedah</option>
        <option>Kelantan</option>
        <option>Kuala Lumpur</option>
        <option>Labuan</option>
        <option>Malacca</option>
        <option>Negeri Sembilan</option>
        <option>Pahang</option>
        <option>Penang</option>
        <option>Perak</option>
        <option>Perlis</option>
        <option>Putrajaya</option>
        <option>Sabah</option>
        <option>Sarawak</option>
        <option>Selangor</option>
        <option>Terengganu</option>
      </select>
    </label>

    <!-- about -->
    <label class="item-input">
      <textarea ng-if="myProfile.user_type==USER_TYPE.SUPPLIER || myProfile.user_type==USER_TYPE.STOCKIST" class="form-control" 
      placeholder="Tell more about your business and if you are looking for agents/suppliers/stockists (optional)" 
      rows="4" ng-model="myProfile.about"></textarea>
    
      <textarea ng-if="myProfile.user_type==USER_TYPE.DROPSHIP" class="form-control" 
      placeholder="Tell more about your business and if you are looking for suppliers/stockists (optional)" 
      rows="4" ng-model="myProfile.about"></textarea>  
    </label>

    <div class="text-center" ng-show="loadingEdit">
          {{loadStatus}}<br>
        <img id="mySpinner" ng-src="{{APP_CONSTANT.LOADER}}"/>
      </div>
      
      <button ng-disabled="!editForm.$valid || loading" type="submit" 
      class="button button-block button-orange" ng-click="submitEditProfile()">Edit Profile</button>

      
    </div>


  </form>

  </div>
  </div>
</div>
</div>
<hr>


<!--- REVIEWS ################################################################################################################################################ -->
<!--- REVIEWS ################################################################################################################################################ -->
<span ng-if="userInSession != null">
<div ng-controller="ReviewController" >
  <a class="link" href="" ng-click="refresh()">
    <h3>Reviews</h3>
  </a>


    <div class="item text-center" ng-show="loadGet">
        <img id="mySpinner" ng-src="{{APP_CONSTANT.LOADER}}"/>
    </div>

    <span ng-show="!loadGet && reviews.length > 0">
      <div ng-repeat="item in reviews" class="text-left">
        <div class="item item-avatar">
          <img src="{{item.from_user_picture}}">
              <p>
        
                <span class="item-body text-muted" style="padding: 0px;">
                  <!--- STAR -->
                  <span class="star">
                    <span ng-repeat="n in range(1,item.star)">
                      <i class="fa fa-star"></i>
                    </span>
                  </span>
                    <span class="star-empty" ng-repeat="n in range(1,item.star.getEmptyStar())">
                      <i class="fa fa-star"></i>
                    </span>                   
                  <!--- STAR -->
                  <br>
                  <small ng-if="item.text != null && item.text != ''" style="font-style:italic;">{{item.text}}<br></small>
                  <small style="font-size:10px;">by <a href="" ng-click="showUser({{item.from_user_id}})">{{item.from_user_name}}</a></small>
                  <small style="font-size:8px;"> on <strong>{{item.updated_at.getDate()}}</strong></small>

                </span>
              
              </p>
          </div>
      </div>
    
      <div class ="item item-body text-center">
          <small style="font-size:10px;">Showing {{loadedReviews}} of {{totalReviews}} reviews</small><br>
          <button ng-if="loadedReviews < totalReviews" class="button button-small button-orange icon-left ion-load-d" 
            ng-click="getMore()">Load More Reviews</button>
      </div>

    </span>
    
    <div class="item item-body text center" ng-show="!loadGet && reviews.length == 0">
        <small>You have no review yet</small>
    </div>

  </div>
</span>
<!--- REVIEWS ################################################################################################################################################ -->
<!--- REVIEWS ################################################################################################################################################ -->


<hr>

</div>

</ion-view>
</ion-content>